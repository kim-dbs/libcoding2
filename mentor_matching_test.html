<!DOCTYPE html>
<html>
<head>
    <title>ë©˜í†  ë§¤ì¹­ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 5px;
            background: #fafafa;
        }
        .success { color: #28a745; font-weight: bold; }
        .error { color: #dc3545; font-weight: bold; }
        .loading { color: #007bff; }
        .warning { color: #ffc107; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        pre { 
            background: #f8f9fa; 
            padding: 10px; 
            border-radius: 3px; 
            overflow-x: auto;
            font-size: 12px;
        }
        .page-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .page-links a {
            background: #6c757d;
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
        }
        .page-links a:hover { background: #545b62; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª ë©˜í†  ë§¤ì¹­ ì‹œìŠ¤í…œ ì¢…í•© í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h2>ğŸ“Š ì„œë²„ ìƒíƒœ í™•ì¸</h2>
            <div id="server-status" class="loading">ì„œë²„ ìƒíƒœ í™•ì¸ ì¤‘...</div>
            <button onclick="checkServers()">ì„œë²„ ìƒíƒœ ì¬í™•ì¸</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ” ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</h2>
            <div>
                <button onclick="loginAsMentee()">ë©˜í‹°ë¡œ ë¡œê·¸ì¸</button>
                <button onclick="loginAsMentor()">ë©˜í† ë¡œ ë¡œê·¸ì¸</button>
                <button onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
            <div id="login-status" class="loading">ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ ì¤‘...</div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“‹ API ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h2>
            <div>
                <button onclick="testMentorsAPI()">ë©˜í†  ëª©ë¡ API</button>
                <button onclick="testProfileAPI()">í”„ë¡œí•„ API</button>
                <button onclick="testRequestsAPI()">ìš”ì²­ ê´€ë¦¬ API</button>
            </div>
            <div id="api-status">API í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ–¥ï¸ í”„ë¡ íŠ¸ì—”ë“œ í˜ì´ì§€ ì ‘ê·¼</h2>
            <div class="page-links">
                <a href="http://localhost:3000" target="_blank">í™ˆ í˜ì´ì§€</a>
                <a href="http://localhost:3000/login" target="_blank">ë¡œê·¸ì¸ í˜ì´ì§€</a>
                <a href="http://localhost:3000/signup" target="_blank">íšŒì›ê°€ì… í˜ì´ì§€</a>
                <a href="http://localhost:3000/profile" target="_blank">í”„ë¡œí•„ í˜ì´ì§€</a>
                <a href="http://localhost:3000/mentors" target="_blank">ë©˜í†  ëª©ë¡ í˜ì´ì§€</a>
                <a href="http://localhost:3000/requests" target="_blank">ìš”ì²­ ê´€ë¦¬ í˜ì´ì§€</a>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ”§ ë°±ì—”ë“œ API ë¬¸ì„œ</h2>
            <div class="page-links">
                <a href="http://localhost:8080" target="_blank">Swagger UI</a>
                <a href="http://localhost:8080/openapi.json" target="_blank">OpenAPI JSON</a>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ‘¥ í…ŒìŠ¤íŠ¸ ê³„ì • ì •ë³´</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <strong>ğŸ¯ ë©˜í‹° ê³„ì •:</strong><br>
                    ğŸ“§ test_mentee@example.com<br>
                    ğŸ”‘ testpass123<br>
                    ğŸ“± ì—­í• : mentee
                </div>
                <div>
                    <strong>ğŸ“ ë©˜í†  ê³„ì •:</strong><br>
                    ğŸ“§ test_mentor@example.com<br>
                    ğŸ”‘ testpass123<br>
                    ğŸ“± ì—­í• : mentor
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤</h2>
            <ol>
                <li><strong>ë©˜í‹°ë¡œ ë¡œê·¸ì¸</strong> â†’ ë©˜í†  ëª©ë¡ í˜ì´ì§€ ì ‘ê·¼</li>
                <li><strong>ë©˜í†  ê²€ìƒ‰/ì •ë ¬</strong> â†’ ê¸°ìˆ ìŠ¤íƒìœ¼ë¡œ í•„í„°ë§</li>
                <li><strong>ë§¤ì¹­ ìš”ì²­ ì „ì†¡</strong> â†’ ë©”ì‹œì§€ì™€ í•¨ê»˜ ìš”ì²­</li>
                <li><strong>ë©˜í† ë¡œ ë¡œê·¸ì¸</strong> â†’ ë°›ì€ ìš”ì²­ í™•ì¸</li>
                <li><strong>ìš”ì²­ ìˆ˜ë½/ê±°ì ˆ</strong> â†’ ìƒíƒœ ë³€ê²½ í™•ì¸</li>
            </ol>
        </div>
    </div>

    <script>
        let currentToken = null;
        let currentUser = null;
        
        async function checkServers() {
            const statusDiv = document.getElementById('server-status');
            statusDiv.innerHTML = '<span class="loading">ì„œë²„ ìƒíƒœ í™•ì¸ ì¤‘...</span>';
            
            let results = [];
            
            // ë°±ì—”ë“œ í™•ì¸
            try {
                const backendResponse = await fetch('http://localhost:8080/', { mode: 'no-cors' });
                results.push('<span class="success">âœ… ë°±ì—”ë“œ ì„œë²„ (8080) ì‹¤í–‰ ì¤‘</span>');
            } catch (error) {
                results.push('<span class="error">âŒ ë°±ì—”ë“œ ì„œë²„ (8080) ì—°ê²° ì‹¤íŒ¨</span>');
            }
            
            // í”„ë¡ íŠ¸ì—”ë“œ í™•ì¸
            try {
                const frontendResponse = await fetch('http://localhost:3000/', { mode: 'no-cors' });
                results.push('<span class="success">âœ… í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ (3000) ì‹¤í–‰ ì¤‘</span>');
            } catch (error) {
                results.push('<span class="error">âŒ í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ (3000) ì—°ê²° ì‹¤íŒ¨</span>');
            }
            
            statusDiv.innerHTML = results.join('<br>');
        }
        
        async function loginAsMentee() {
            await login('test_mentee@example.com', 'testpass123', 'mentee');
        }
        
        async function loginAsMentor() {
            await login('test_mentor@example.com', 'testpass123', 'mentor');
        }
        
        async function login(email, password, expectedRole) {
            const statusDiv = document.getElementById('login-status');
            statusDiv.innerHTML = '<span class="loading">ë¡œê·¸ì¸ ì‹œë„ ì¤‘...</span>';
            
            try {
                const response = await fetch('http://localhost:8080/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (data.token) {
                    currentToken = data.token;
                    
                    // í† í°ìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                    const userResponse = await fetch('http://localhost:8080/api/me', {
                        headers: { 'Authorization': 'Bearer ' + currentToken }
                    });
                    
                    if (userResponse.ok) {
                        currentUser = await userResponse.json();
                        statusDiv.innerHTML = 
                            '<span class="success">âœ… ' + expectedRole + ' ë¡œê·¸ì¸ ì„±ê³µ</span><br>' +
                            '<strong>ì‚¬ìš©ì ì •ë³´:</strong><br>' +
                            'ì´ë¦„: ' + currentUser.profile.name + '<br>' +
                            'ì—­í• : ' + currentUser.role + '<br>' +
                            'ì´ë©”ì¼: ' + currentUser.email;
                    } else {
                        statusDiv.innerHTML = '<span class="warning">âš ï¸ ë¡œê·¸ì¸ì€ ì„±ê³µí–ˆì§€ë§Œ ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>';
                    }
                } else {
                    statusDiv.innerHTML = '<span class="error">âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + JSON.stringify(data) + '</span>';
                }
            } catch (error) {
                statusDiv.innerHTML = '<span class="error">âŒ ë¡œê·¸ì¸ ì˜¤ë¥˜: ' + error.message + '</span>';
            }
        }
        
        function logout() {
            currentToken = null;
            currentUser = null;
            document.getElementById('login-status').innerHTML = '<span class="warning">ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ</span>';
            document.getElementById('api-status').innerHTML = 'API í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.';
        }
        
        async function testMentorsAPI() {
            if (!currentToken) {
                document.getElementById('api-status').innerHTML = '<span class="error">âŒ ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”.</span>';
                return;
            }
            
            try {
                const response = await fetch('http://localhost:8080/api/mentors', {
                    headers: { 'Authorization': 'Bearer ' + currentToken }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('api-status').innerHTML = 
                        '<span class="success">âœ… ë©˜í†  ëª©ë¡ API ì„±ê³µ</span><br>' +
                        '<strong>ë©˜í†  ìˆ˜:</strong> ' + data.length + 'ëª…<br>' +
                        '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                } else {
                    document.getElementById('api-status').innerHTML = 
                        '<span class="error">âŒ ë©˜í†  ëª©ë¡ API ì‹¤íŒ¨</span><br>' +
                        '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                }
            } catch (error) {
                document.getElementById('api-status').innerHTML = '<span class="error">âŒ API í˜¸ì¶œ ì˜¤ë¥˜: ' + error.message + '</span>';
            }
        }
        
        async function testProfileAPI() {
            if (!currentToken) {
                document.getElementById('api-status').innerHTML = '<span class="error">âŒ ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”.</span>';
                return;
            }
            
            try {
                const response = await fetch('http://localhost:8080/api/me', {
                    headers: { 'Authorization': 'Bearer ' + currentToken }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('api-status').innerHTML = 
                        '<span class="success">âœ… í”„ë¡œí•„ API ì„±ê³µ</span><br>' +
                        '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                } else {
                    document.getElementById('api-status').innerHTML = 
                        '<span class="error">âŒ í”„ë¡œí•„ API ì‹¤íŒ¨</span><br>' +
                        '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                }
            } catch (error) {
                document.getElementById('api-status').innerHTML = '<span class="error">âŒ API í˜¸ì¶œ ì˜¤ë¥˜: ' + error.message + '</span>';
            }
        }
        
        async function testRequestsAPI() {
            if (!currentToken) {
                document.getElementById('api-status').innerHTML = '<span class="error">âŒ ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”.</span>';
                return;
            }
            
            if (!currentUser) {
                document.getElementById('api-status').innerHTML = '<span class="error">âŒ ì‚¬ìš©ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</span>';
                return;
            }
            
            try {
                let endpoint = currentUser.role === 'mentor' ? 'incoming' : 'outgoing';
                const response = await fetch('http://localhost:8080/api/match-requests/' + endpoint, {
                    headers: { 'Authorization': 'Bearer ' + currentToken }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('api-status').innerHTML = 
                        '<span class="success">âœ… ' + (currentUser.role === 'mentor' ? 'ë°›ì€' : 'ë³´ë‚¸') + ' ìš”ì²­ API ì„±ê³µ</span><br>' +
                        '<strong>ìš”ì²­ ìˆ˜:</strong> ' + data.length + 'ê°œ<br>' +
                        '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                } else {
                    document.getElementById('api-status').innerHTML = 
                        '<span class="error">âŒ ìš”ì²­ ëª©ë¡ API ì‹¤íŒ¨</span><br>' +
                        '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                }
            } catch (error) {
                document.getElementById('api-status').innerHTML = '<span class="error">âŒ API í˜¸ì¶œ ì˜¤ë¥˜: ' + error.message + '</span>';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì„œë²„ ìƒíƒœ í™•ì¸
        window.onload = () => {
            checkServers();
        };
    </script>
</body>
</html>
